{% extends "base.html" %}

{% block title %}Detalle del Pedido{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pedidos/pedidos_detalle.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <h1><i class="fas fa-receipt"></i> Detalle del Pedido #{{ pedido.id }}</h1>

    <div class="info-pedido">
        <p><strong>Cliente:</strong> {{ pedido.cliente.nombre }}</p>
        <p><strong>Estado:</strong> {{ pedido.estado|capitalize }}</p>
        <p><strong>Fecha del Pedido:</strong> {{ pedido.fecha_pedido.strftime('%d/%m/%Y') }}</p>
        <p><strong>Fecha de Entrega:</strong> {{ pedido.fecha_entrega.strftime('%d/%m/%Y') }}</p>
    </div>

    <div class="detalle-productos">
        <h2>Productos</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Precio Unitario</th>
                    <th>Cantidad</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for detalle in pedido.detalles %}
                <tr>
                    <td>{{ detalle.producto.nombre }}</td>
                    <td>${{ "%.2f"|format(detalle.precio_unitario) }}</td>
                    <td>{{ detalle.cantidad }}</td>
                    <td>${{ "%.2f"|format(detalle.subtotal) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="total">
            <strong>Total del Pedido: ${{ "%.2f"|format(pedido.total) }}</strong>
        </div>
    </div>

    <div class="acciones">
    <a href="{{ url_for('pedidos.listar') }}" class="btn-volver">
        <i class="fas fa-arrow-left"></i> Volver
    </a>
    <a href="{{ url_for('pedidos.ver_factura', pedido_id=pedido.id) }}" class= "btn-descargar-factura" target="_blank">
        <i class="fas fa-file-download"></i> Descargar Factura
    </a>
</div>
</div>
{% endblock %}
